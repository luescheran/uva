Straightforward / brute force simulation.

My algorithm is not very efficient. It is possible to precompute pairs and also to prune solutions > n (but I have not done this).
